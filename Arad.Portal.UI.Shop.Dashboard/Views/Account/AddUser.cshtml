@model Arad.Portal.DataLayer.Models.User.RegisterUserModel
@{
    var alert = Language.GetString("AlertAndMessage_GotIt");
    var error = Language.GetString("AlertAndMessage_Error");
}


<link href="~/lib/intl-tel-input/css/intlTelInput.css" rel="stylesheet" />
<link rel="stylesheet" href="~/lib/iCheck/skins/all.css">
<style>
    .text-danger{
        font-size:12px;
    }
</style>


<h4>  @Language.GetString("AddUserPart_Title") </h4>
<hr />
<div class="row">
    <div class="col-md-12">
        <div class="card card-primary" id="addUserCard">
            <div class="card-header">
                <h3 class="card-title">@Language.GetString("AddUserPart_Title")</h3>
            </div>
            <form role="form" id="addUserFrm" asp-action="AddUser" asp-controller="Account" method="post">
                <div class="card-body">
                    <div class="row">
                        <div class="form-group col-md-3">
                            <label for="Name">@Language.GetString("User_FirstName")</label>
                            <input asp-for="Name" type="text" class="form-control" placeholder=" ">
                            <span data-val-result="Name" class="text-danger"></span>
                        </div>
                        <div class="form-group col-md-3">
                            <label for="LastName">@Language.GetString("User_LastName")</label>
                            <input asp-for="LastName" type="text" class="form-control" placeholder=" ">
                            <span data-val-result="LastName" class="text-danger"></span>
                        </div>
                        <div class="form-group col-md-3">
                            <label for="UserName">@Language.GetString("User_UserName")</label>
                            <input asp-for="UserName" type="text" class="form-control" placeholder=" ">
                            <span data-val-result="UserName" class="text-danger"></span>
                        </div>
                        <div class="form-group col-md-3">
                            <label for="PhoneNumber">@Language.GetString("User_PhoneNumber")</label><br/>
                            <input asp-for="PhoneNumber" type="tel" class="form-control" placeholder=" "><br/>
                            <span data-val-result="PhoneNumber" class="text-danger"></span>
                            <input id="hidePhone" type="hidden" value="" name="FullMobile" />
                        </div>
                    </div>
                    <div class="row">
                        <div class="form-group col-md-3">
                            <label for="Password">@Language.GetString("User_Password")</label>
                            <input asp-for="Password" type="password" class="form-control" placeholder=" ">
                            <span data-val-result="Password" class="text-danger"></span>
                        </div>
                        <div class="form-group col-md-3">
                            <label for="RePassword">@Language.GetString("User_RePassword")</label>
                            <input asp-for="RePassword" type="password" class="form-control" placeholder=" ">
                            <span data-val-result="RePassword" class="text-danger"></span>
                        </div>
                        <div class="form-group col-md-3">
                            <label for="IsActive">@Language.GetString("ActivationState")</label><br/>
                            <input @(Model.IsActive ? "checked" : false) asp-for="IsActive" type="radio"  @*data-toggle="toggle"*@ 
                                   value="true" class="flat-red"
                                   @*data-onstyle="success" data-offstyle="dark"*@><span>@Language.GetString("Active")</span></input>
                            <input @(!Model.IsActive ? "checked" : false) asp-for="IsActive" type="radio"  @*data-toggle="toggle"*@
                                   value="false" class="flat-red"
                                   @*data-onstyle="success" data-offstyle="dark"*@><span>@Language.GetString("InActive")</span></input>
                            <span data-val-result="IsActive" class="text-danger"></span>
                        </div>
                        <div class="form-group col-md-3">
                            <label for="UserRoleId">@Language.GetString("User_Roles")</label>
                            <select class="form-control select2" asp-for="UserRoleId" asp-items="@(new SelectList(Model.Roles,"Id","Title"))">
                            </select>
                            <span data-val-result="UserRoleId" class="text-danger"></span>
                        </div>
                    </div>
                </div>
                @*<div class="row">*@
                <div class="card-footer">
                    <div class="row">
                        @*<div class="form-group">*@
                            <input type="submit" value="@Language.GetString("btn_Add")" class="btn btn-block btn-success" />
                            <a asp-action="List" class="btn btn-block btn-default">@Language.GetString("btn_Back")</a>
                        @*</div>*@
                    </div>
                </div>
                @*</div>*@
            </form>
        </div>
    </div>
</div>


@section Scripts
{
    <script src="~/lib/twbs-pagination/jquery.twbsPagination.js"></script>
    <script src="~/lib/intl-tel-input/js/intlTelInput-jquery.min.js"></script>
    <script src="~/lib/intl-tel-input/js/intlTelInput.js"></script>
    <script src="~/lib/MD.BootstrapPersianDateTimePicker/dist/jquery.md.bootstrap.datetimepicker.js"></script>
    <script src="~/lib/iCheck/icheck.min.js"></script>

    <script type="text/javascript">
    $(document).ready(function () {

    var input = document.querySelector("#PhoneNumber");

    window.intlTelInput(input,
    {
    initialCountry: "IR",
    placeholderNumberType: "MOBILE",
    separateDialCode: true,
    utilsScript: "../../lib/intl-tel-input/js/utils.js",
    nationalMode: true,
    hiddenInput: "FullMobile"
    });


    $("#addUserFrm").submit(function (e) {

    e.preventDefault();
    var frm = document.getElementById('addUserFrm');
    var form = new FormData(frm);
    /*form.append("FullMobile", $("#hidePhone").val());*/

    $.ajax({
    url: $(this).attr('action'),
    data: form,
    type: 'Post',
    processData: false,
    contentType: false,
    beforeSend: function() {
    AddLoading($("#addUserCard"));
    },
    success: function (result) {

    if(result.status === "success") {

    Swal.fire({
    icon: 'success',
    text: result.message,
    confirmButtonText:
    '<i class="fa fa-thumbs-up"></i> @alert',
    });
    } else if (result.status === "error") {
    var spanErrorList = $('span[data-val-result]');

    if (spanErrorList.length > 0) {
    spanErrorList.each(function() {
    $(this).html("");
    $(this).parent().removeClass("has-error");
    });
    } else {
    spanErrorList.html("");
    spanErrorList.parent().removeClass("has-error");
    }

    if (result.modelStateErrors.length > 0) {
    debugger;
    result.modelStateErrors.forEach(function(value, index) {
    $('[data-val-result=' + value.key + ']').html(value.errorMessage);
    $('[data-val-result=' + value.key + ']').parent().addClass("has-error");
    });
    } else {
    Swal.fire({
    icon: 'error',
    text: result.message,
    confirmButtonText:
    '<i class="fa fa-thumbs-up"></i> @alert',
    });
    }
    }

    },
    error: function (xhr, ajaxOptions, thrownError) {
        alert("@error");
        alert(xhr.status);
        alert(thrownError);
    },
    complete: function () {
    removeLoading($("#addUserCard"));
    }
    });
    });

    }
    );
    </script>
}