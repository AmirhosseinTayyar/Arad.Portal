@model Arad.Portal.DataLayer.Models.Permission.UserPermissionViewModel
@using Arad.Portal.DataLayer.Models.Shared;
@{
//Layout = "~/Views/Shared/_Layout.cshtml";
}
@section Styles{
    <link href="~/lib/bootstrap-iconpicker/css/bootstrap-iconpicker.css" rel="stylesheet" />
    <link href="~/lib/intl-tel-input/css/intlTelInput.css" rel="stylesheet" />
    <link rel="stylesheet" href="~/lib/iCheck/skins/all.css">
    <style>
        .text-danger {
            font-size: 12px;
        }
    </style>
}


<h4>  @Language.GetString("Menu_Permissions") </h4>
<hr />
<div class="row">
    <div class="col-md-12">
        <div class="card card-primary" id="addPermissionCard">
            <div class="card-header">
                <h3 class="card-title" data-toggle="tab">@(Model.IsEditView ? Language.GetString("EditPermissionPart_Title") : Language.GetString("AddPermissionPart_Title"))</h3>
            </div>
            <form asp-controller="Permission" role="form" asp-action="Save" id="addEditPermissionFrm" method="post">
                @{
                    if (Model.IsEditView)
                    {
                        <input type="hidden" value="@Model.Id" data-val="true" asp-for="Id">
                        <input type="hidden" value="@Model.IsEditView" data-val="true" asp-for="IsEditView" />
                    }
                }
                <div class="card-body" id="addEditPermissionCard">
                    <div class="row">
                        <div class="form-group col-md-3">
                            
                            <label asp-for="Title">@Language.GetString("Per_PermissionTitle")</label>
                            <input type="text" class="form-control" asp-for="Title" placeholder=" ">
                            <span data-val-result="Title" class="text-danger"></span>
                        </div>
                        <div class="form-group col-md-3" id="TypeSelect">
                            <label asp-for="Type">@Language.GetString("Per_PermissionType")</label>
                            <select asp-for="Type" class="form-control select2" name="Type" asp-items="Html.GetEnumSelectList<Enums.PermissionType>()">
                            </select>
                            <span data-val-result="Type" class="text-danger"></span>
                        </div>
                        <div  class="form-group col-md-3" id="MethodSelect">
                            <label asp-for="Method">@Language.GetString("Per_PermissionMethod")</label>
                            <select asp-for="Method" class="form-control select2" name="Method" asp-items="Html.GetEnumSelectList<Enums.PermissionMethod>()">
                            </select>
                            <span class="text-danger" data-val-result="Method"></span>
                        </div>
                        <div class="form-group col-md-3" id="MenuIdOfModulePart">
                            <label asp-for="MenuIdOfModule">@Language.GetString("Per_MenuIdOfModule")</label>
                            <select asp-for="MenuIdOfModule" class="form-control select2" name="MenuIdOfModule">
                            </select>
                            <span class="text-danger" data-val-result="MenuIdOfModule"></span>
                        </div>

                    </div>
                    <div class="row">
                        <div class="form-group col-md-6" id="RoutePer">
                            <label asp-for="Routes">@Language.GetString("Per_Routes")</label>
                            <textarea  class="form-control" asp-for="Routes"
                                   dir="ltr" placeholder="@Language.GetString("Menu_RoutePlaceHolder")">@Model.Routes</textarea>
                            <span class="text-danger" data-val-result="Routes"></span>
                        </div>
                        <div class="form-group col-md-4" id="ParentMenuSelect" style="display:none;">
                            <label asp-for="ParentMenuId">@Language.GetString("Per_ParentMenuId")</label>
                            <select asp-for="ParentMenuId" class="form-control select2">
                            </select>
                            <span class="text-danger" data-val-result="ParentMenuId"></span>
                        </div>
                    </div>
                    <div class="row">
                        <div class="form-group col-md-3" id="IconPart">
                            <label asp-for="Icon">@Language.GetString("Per_Icon")</label>
                            <input type="text" class="form-control" asp-for="Icon" dir="ltr">
                            <span class="text-danger" data-val-result="Icon"></span>
                        </div>
                        <div class="form-group col-md-3" id="PriorityPart">
                            <label asp-for="Priority">@Language.GetString("Per_Priority")</label>
                            <input type="number" class="form-control" asp-for="Priority" dir="ltr" value="1" min="1">
                            <span class="text-danger" data-val-result="Priority"></span>
                        </div>
                        <div class="form-group col-md-3" id="ClientAddressPart">
                            <label asp-for="ClientAddress">@Language.GetString("Per_ClientAddress")</label>
                            <input type="tel" class="form-control" asp-for="ClientAddress" dir="ltr">
                            <span class="text-danger" data-val-result="ClientAddress"></span>
                        </div>
                        @{
                            if (Model.IsEditView)
                            {
                                <div class="orm-group col-md-3">
                                    <label asp-for="ModificationReason">@Language.GetString("ModificationReason")</label>
                                    <textarea dir="rtl" asp-for="ModificationReason" class="form-control" rows="3"></textarea>
                                    <span data-val-result="ModificationReason" class="text-danger"></span>
                                </div>
                            }
                        }
                    </div>
                </div>
                <div class="card-footer">
                    <div class="row">
                        <input type="submit" value="@Language.GetString("btn_Save")" class="btn btn-block btn-success" />
                        <a asp-action="List" class="btn btn-block btn-default">@Language.GetString("btn_Back")</a>
                    </div>
                </div>
            </form>
        </div>
    </div>
</div>
@section Scripts{ 
    <script>
        $(document).ready(function () {
            debugger;
            MenusSelectList(1);
            MenusSelectList(2);


            $("#Type").change(function () {
                switch ($(this).val()) {
                    case "0":
                        $("#MethodSelect").css("display", "block");
                        $("#PriorityPart").css("display", "none");
                        $("#IconPart").css("display", "none");
                        $("#MenuIdOfModulePart").css("display", "block");
                        $("#ParentMenuSelect").css("display", "none");
                        $("#RoutePer").css("display", "block");
                        $("#ClientAddressPart").css("display", "none");
                        break;
                    case "1":
                        $("#MethodSelect").css("display", "none");
                        $("#PriorityPart").css("display", "block");
                        $("#IconPart").css("display", "block");
                        $("#MenuIdOfModulePart").css("display", "none");
                        $("#ParentMenuSelect").css("display", "block");
                        $("#RoutePer").css("display", "block");
                        $("#ClientAddressPart").css("display", "block");
                        break;
                    case "2":
                        $("#MethodSelect").css("display", "none");
                        $("#PriorityPart").css("display", "block");
                        $("#IconPart").css("display", "block");
                        $("#MenuIdOfModulePart").css("display", "none");
                        $("#ParentMenuSelect").css("display", "none");
                        $("#RoutePer").css("display", "block");
                        $("#ClientAddressPart").css("display", "none");
                        break;
                }
            });
    });
     function MenusSelectList(typemenu) {

                data = { typeMenu: typemenu };
                $.ajax({
                    url: "@Url.Action("MenusSelectList")",
                    type: 'Get',
                    data: data,
                    success: function (result) {
                        var options = "<option value='-1'>انتخاب کنید..</option>";
                        if (result.status === "success") {
                            if (result.data.length != 0) {
                                (result.data).forEach(function(item) {
                                    var op = "<option value='" + item.permissionid + "'>" + item.title + "</option>";
                                    options += op;
                                });
                            }

                        } else if (result.status === "error") {


                        }
                        if (typemenu === 1) {
                            $("#MenuIdOfModule").html(options);
                            $('#MenuIdOfModule').selectpicker('refresh');

                            $("#MenuIdOfModule").html(options);
                            $('#MenuIdOfModule').selectpicker('refresh');
                        } else if (typemenu === 2) {
                            $("#ParentMenuId").html(options);
                            $('#ParentMenuId').selectpicker('refresh');

                            $("#ParentMenuId").html(options);
                            $('#ParentMenuId').selectpicker('refresh');
                        }
                    },
                    //error: function(xhr, ajaxOptions, thrownError) {
                    //    alert("error");
                    //    alert(xhr.status);
                    //    alert(thrownError);
                    //},
                    complete: function() {
                    }
                });
            }
    </script>
}

 

